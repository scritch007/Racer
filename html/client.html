<!DOCTYPE html>
<head>
<meta charset="utf-8">
<script src="/static/js/common.js"></script>
<script>
screen.orientation.lock('landscape');
window.addEventListener("load", function(evt) {
	function deviceOrientationListener(event) {
		//Send to the server the current alpha
		var newmessage = JSON.stringify({
			t: EnumMessage.MOVE,
			s: 0,
			m: ""+event.beta
		})
		ws.send(newmessage);
  }

  if (window.DeviceOrientationEvent) {
		window.addEventListener("deviceorientation", deviceOrientationListener);
  } else {
		alert("Sorry, your browser doesn't support Device Orientation");
  }

  var output = document.getElementById("output");
	var ws;
	ws = new WebSocket("{{.}}");
	ws.onopen = function(evt) {
		console.log("OPEN");
	}
	ws.onclose = function(evt) {
		console.log("CLOSE");
		ws = null;
	}
	ws.onmessage = function(evt) {
		console.log("RESPONSE: " + evt.data);
	}
	ws.onerror = function(evt) {
		console.log("ERROR: " + evt.data);
	}
	return false;
});
</script>
</head>
<body>
<h2>Hi, client, this is now your gamepad.</h2>
Start Moving your gamepad to control the square on the screen
<div id="debug"></div>
</body>
</html>